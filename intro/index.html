<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction · Neural ODE Project</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Neural ODE Project</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Introduction</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li></ul></li><li><a class="tocitem" href="../model/">Model</a></li><li><a class="tocitem" href="../discussion/">Discussion</a></li><li><a class="tocitem" href="../refs/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Introduction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Introduction</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="github.com/April-Hannah-Lena/NeuralODEProject.jl/blob/main/docs/src/intro.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Modeling-Chua&#39;s-Circuit-using-a-Neural-Ordinary-Differential-Equation"><a class="docs-heading-anchor" href="#Modeling-Chua&#39;s-Circuit-using-a-Neural-Ordinary-Differential-Equation">Modeling Chua&#39;s Circuit using a Neural Ordinary Differential Equation</a><a id="Modeling-Chua&#39;s-Circuit-using-a-Neural-Ordinary-Differential-Equation-1"></a><a class="docs-heading-anchor-permalink" href="#Modeling-Chua&#39;s-Circuit-using-a-Neural-Ordinary-Differential-Equation" title="Permalink"></a></h1><p>April Herwig</p><p>March 2023</p><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>Chua&#39;s circuit is a standard case study in the literature on chaotic dynamics [9]. The simplicity of the mathematical model, a non-stiff three-dimensional system of ordinary differential equations, makes it an attractive example for many numerical experiments. The goal of this project is to train a neural ordinary differential equation using trajectory data, and determine a (heuristic) minimal amount of data required to obtain a satisfying model. </p><p>Chua&#39;s circuit was initially developed in 1986 with the goal (among others) to determine whether chaotic dynamics can appear in real-life continuous dynamical systems, or if chaos could only exist in mathematical abstraction [4]. Indeed, a strange attractor observed in experiment [10], matching the one observed through numerical simulation. </p><p>A schematic diagram of the simplest canonical Chua&#39;s circuit is given in the below figure [2]. It consists of four components connected in parallel: two capacitors (<span>$C_1$</span> and <span>$C_2$</span>) with a resistor <span>$R$</span> connected between them, as well as an inductor <span>$L$</span> and a <em>nonlinear negative resistance</em> component <span>$N_R$</span> called a <em>Chua diode</em> [8]. </p><p><img src="../assets/Chua&#39;s_circuit_with_Chua_diode.svg" alt="Circuit diagram"/></p><p>Using Kirchoff&#39;s laws one derives a set of equations for the three energy storing components. After nondimensionalization the system can be written in a (simplified) canonical form [5]</p><p class="math-container">\[\begin{cases}
    \dot{x} &amp;= \alpha \left( y - m_0 x - m_1 f(x) \right) \\
    \dot{y} &amp;= x - y + z \\
    \dot{z} &amp;= - \beta y . 
\end{cases}\]</p><p>where <span>$\alpha, \beta, m_0, m_1$</span> are real paramters and <span>$f$</span> is a nonlinear function with fixed point <span>$0$</span>. Note that aside from <span>$f$</span>, the system is entirely linear and hence will not exhibit chaotic behavior. The original Chua oscillator used a piecewise linear function representing the diode&#39;s resistance graph, shown below [3]. However, many simpler (and smoother) functions still exhibit chaotic dynamics while being more suitable for convergence proofs of numerical algorithms. This project will use a cubic nonlinearity <span>$f(x) = \frac{1}{3} x^3$</span> with parameters <span>$\alpha = 18,\ \beta = 33,\ m_0 = -0.2,\ m_1 = 0.01$</span>.</p><p><img src="../assets/Chua_diode_characteristic_curve.svg" alt="Voltage-Current Graph"/></p><p>The Chua oscillator exhibits a strange attractor referred to as the double scroll, as well as a surrounding periodic orbit. These can be initially supposed by observing long trajectories beginning around the two unstable fixed points <span>$x_\pm = \left( \pm \sqrt{-3 m_0 / m_1},\ 0,\ \mp \sqrt{-3 m_0 / m_1} \right)^T$</span>. </p><pre><code class="language-julia hljs">using CairoMakie</code></pre><pre><code class="language-julia hljs"># for plotting phase portraits
function chua_axis(; aspect=(1,1.2,1), azimuth=pi/10)
    fig = Figure()
    ax = Axis3(fig[1,1], aspect=aspect, azimuth=azimuth)
    fig, ax
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">chua_axis (generic function with 1 method)</code></pre><pre><code class="language-julia hljs">using StaticArrays, OrdinaryDiffEq</code></pre><pre><code class="language-julia hljs"># Chua&#39;s circuit
function v(u, p, t)
    x, y, z = u
    a, b, m0, m1 = p
    SA{Float32}[ a*(y-m0*x-m1/3.0*x^3), x-y+z, -b*y ]
end

# parameters
p_ode = SA{Float32}[ 18.0, 33.0, -0.2, 0.01 ]
a, b, m0, m1 = p_ode

v(u) = v(u, p_ode, 0f0)

# equilibrium
x₊ = SA{Float32}[ sqrt(-3*m0/m1), 0, -sqrt(-3*m0/m1) ]
x₋ = -x₊

# integration time
t0, t1 = 0f0, 40f0
tspan = (t0, t1)
dt = 1f-2</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.01f0</code></pre><pre><code class="language-julia hljs">x0 = SA{Float32}[2, 1.5, 6]
prob = ODEProblem(v, x0, (t0, t1), p_ode)
sol = solve(prob, RK4(), saveat=dt)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: 1st order linear
t: 4001-element Vector{Float32}:
  0.0
  0.01
  0.02
  0.03
  0.04
  0.05
  0.06
  0.07
  0.08
  0.09
  ⋮
 39.92
 39.93
 39.94
 39.95
 39.96
 39.97
 39.98
 39.99
 40.0
u: 4001-element Vector{SVector{3, Float32}}:
 [2.0, 1.5, 6.0]
 [2.3478057, 1.5638899, 5.4943976]
 [2.7161942, 1.625573, 4.9680758]
 [3.1040666, 1.6850694, 4.4217606]
 [3.5098338, 1.7423917, 3.85617]
 [3.931378, 1.7975401, 3.2720225]
 [4.3661227, 1.8505011, 2.6700351]
 [4.8108993, 1.9012377, 2.0509377]
 [5.2620163, 1.9496877, 1.4154711]
 [5.715368, 1.9957609, 0.7644038]
 ⋮
 [7.952575, 0.6612285, -4.0163784]
 [8.055006, 0.6932301, -4.2398586]
 [8.1548, 0.7236258, -4.473609]
 [8.251635, 0.7523293, -4.717283]
 [8.345165, 0.77921474, -4.9700155]
 [8.435227, 0.80420536, -5.231357]
 [8.521514, 0.8271842, -5.500463]
 [8.603853, 0.8480714, -5.7768965]
 [8.681946, 0.8667533, -6.059803]</code></pre><pre><code class="language-julia hljs">fig, ax = chua_axis()
scatter!(ax, [x₊, SA[0f0,0f0,0f0], x₋], color=:red, label=&quot;Equillibria&quot;)
lines!(ax, sol.u, label=&quot;Inner Attractor&quot;)
Legend(fig[1,2], ax)</code></pre><p><img src="../inner.png" alt/></p><pre><code class="language-julia hljs">x0 = SA{Float32}[2, 1.5, 6]
prob = ODEProblem(v, x0, (t0, t1), p_ode)
sol = solve(prob, RK4(), saveat=dt)

fig, ax = chua_axis()
scatter!(ax, [x₊, SA[0f0,0f0,0f0], x₋], color=:red, label=&quot;Equillibria&quot;)
lines!(ax, sol.u, label=&quot;Inner Attractor&quot;)

# only slightly different initial condition
x0 = SA{Float32}[2, 1.5, 8]
prob = ODEProblem(v, x0, (t0, t1), p_ode)
sol = solve(prob, RK4(), saveat=dt)

lines!(ax, sol.u, color=:green, label=&quot;Outer Attractor&quot;)
Legend(fig[1,2], ax)</code></pre><p><img src="../outer.png" alt/></p><p>The existence of the attractor can be numerically proven using a subdivision algorithm from the Julia package GAIO.jl [7], which provides an outer approximation of the unstable manifolds of <span>$x_\pm$</span> as well as the chain recurrent set. </p><pre><code class="language-julia hljs">using GAIO</code></pre><pre><code class="language-julia hljs"># domain
c, r = (0,0,0), (20,5,20)
Q = GAIO.Box(c, r)

# 120 x 120 x 120 partition of the domain
P = BoxPartition(Q, (120,120,120))
S = cover(P, [x₊, x₋])

# short trajectory (20 steps) to fully cover unstable manifold
f_short(u) = rk4_flow_map(v, u, dt, 20)
F_short = BoxMap(:grid, f_short, Q)

W = unstable_set(F_short, S)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">53561 - element BoxSet in 120 x 120 x 120 - element BoxPartition</code></pre><pre><code class="language-julia hljs">fig, ax = chua_axis(azimuth=3*pi/10)
plot!(ax, W, color=(:blue, 0.5))</code></pre><p><img src="../unstable.png" alt/></p><pre><code class="language-julia hljs"># extend the domain
c, r = (0,0,0), (20,20,120)
Q = GAIO.Box(c, r)

# 1 x  x 1 partition of the domain
P = BoxPartition(Q, (1,1,1))
S = cover(P, :)

# long trajectory to avoid covering &quot;transitional&quot; set
f_long(u) = rk4_flow_map(v, u, dt, 100)
F_long = BoxMap(:grid, f_long, Q)

# 30 subdivision steps to cover the chain recurrent set
C = chain_recurrent_set(F_long, S, steps=24)

# remove the unstable manifold which we already found
P = C.partition
W = cover(P, W)
C = setdiff!(C, W)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">9192 - element BoxSet in 256 x 256 x 256 - element BoxPartition</code></pre><pre><code class="language-julia hljs">fig, ax = chua_axis(azimuth=pi/5)
plot!(ax, W, color=(:blue, 0.6))
plot!(ax, C, color=(:green, 0.6))</code></pre><p><img src="../rec.png" alt/></p><pre><code class="language-julia hljs"># full interesting set
A = C ∪ W

# short trajectory for computing FTLE field
σ = finite_time_lyapunov_exponents(F_short, A, T=20*dt)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BoxFun in 256 x 256 x 256 - element BoxPartition with 39943 stored weights</code></pre><pre><code class="language-julia hljs">fig, ax = chua_axis()
ms = plot!(ax, σ, colormap=(:jet, 0.6))
Colorbar(fig[1,2], ms)</code></pre><p><img src="../ftle.png" alt/></p><p>We can conclude that the most chaotic behavior occurs for points lying on the &quot;transition&quot; between to two scrolls of the attractor. We will train two models on long trajectories with different starting values: </p><ul><li>along the unstable manifold,</li><li>approaching the periodic orbit.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../model/">Model »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 4 April 2023 20:34">Tuesday 4 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
